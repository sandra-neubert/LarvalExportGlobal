# Larval Export from MPAs

This repository provides the code to the study "Larval export mitigates the cost of conservation to fisheries in over-exploited waters". Briefly, we couple Lagrangian particle tracking to simulate passive larval movement with the global, spatially-resolved bioeconomic trophic size-spectrum model BOATS to estimate fish biomass and harvest. We then explore two 30âœ•30 MPA scenarios that maximise economic and biodiversity benefit respectively to test how much incorporating larval movement in a marine ecosystem model could offset the projected loss to fisheries upon MPA implementation. 
<br>
The code can be divided into four main sections:
<br>
* **Particle Tracking:** Preprocessing scripts for particle tracking can be found in Analysis/Notebooks and Analysis/PythonScripts. Near-global particle tracking is done in Python with [Parcels](https://oceanparcels.org/#whatisparcels) by [Delandmeter and van Sebille (2019)](https://www.geosci-model-dev.net/12/3571/2019/gmd-12-3571-2019.html), performed with Analysis/Movement/PythonScripts/HPCParticleTrackingScript.py and requires a high perfomance computer. We also provide the PBS file that was used to run the particle tracking on Katana at UNSW (Analysis/Movement/PythonScripts/HPCParticleTrackingScript.pbs).
* **Calculating the transition matrix with movement probabilities:** The output of the particle tracking was processed to monthly transition matrices in R using the scripts in Analysis/Movement/RScripts/ProbabilityMatrix, specifically the script Calculate_ProbMatPTGlobalCompile25Y.R. This analysis also requires a high performance computer and we provide the PBS files used to calculate the transition matrices on Katana at UNSW (Analysis/Movement/RScripts/ProbabilityMatrix/StartCompile25Y.pbs).
* **Global bioeconomic modelling simulations:** We used the publicly available BiOeconomic mArine Trophic Size-spectrum model ([BOATS](https://github.com/obeg-boats)) by Carozza et al. ([2016](https://earthsystemdynamics.org/wp-content/uploads/2018/05/Carozza-GMD-2016-BOATS.pdf), [2017](https://earthsystemdynamics.org/wp-content/uploads/2018/05/Carozza-PLoS-2017-BOATS.pdf)) to simulate whether egg/larval movement can offset lost fishing following MPA implementation. The version of BOATS including egg/larval movement can be found in Analysis/BOATS/sneubert-boats_v1 with instructions on how to run the model in the doc folder. Running BOATS as available here also requires a high performance computer. 
* **Analysis of simulations:** BOATS outputs were analysed in MATLAB using the scripts available in the folders prepareOutput_SN and plotting_scripts_SN. The output was further analysed in R with the scripts in Analysis/Movement/RScripts/AnalysisBOATSoutput using a Generalised Linear Model (GLM folder) and by assessing the changes in individual Large Marine Ecosystems (LME folder).
